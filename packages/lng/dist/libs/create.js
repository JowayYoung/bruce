var x=this&&this.__awaiter||function(o,e,t,n){return new(t||(t=Promise))((function(r,a){function i(o){try{c(n.next(o))}catch(o){a(o)}}function s(o){try{c(n.throw(o))}catch(o){a(o)}}function c(o){var e;o.done?r(o.value):(e=o.value,e instanceof t?e:new t((function(o){o(e)}))).then(i,s)}c((n=n.apply(o,e||[])).next())}))};import{exit as s}from"node:process";import{AbsPath as E}from"@yangzw/bruce-us/dist/node.js";import So from"exceljs";import no from"ora";import{CreateAnswer as ge}from"../helpers/index.js";import{CREATE_TEXT as h}from"../langs/index.js";import{LANG_TEXT as Wo,ShowTitle as io}from"../utils/index.js";export default function u(){return x(this,void 0,void 0,(function*(){io("create");const{cover:o,features:e,jsons:t,langs:n}=yield ge();!o&&s(1);const r=no(h.doing).start(),a=new So.Workbook,i={bold:!0,color:{argb:"ff333333"},family:3,name:"Microsoft YaHei",size:14};a.creator="JowayYoung",t.length?t.forEach((o=>{var e;const t=a.addWorksheet(o.name,{views:[{state:"frozen",xSplit:1,ySplit:1}]}),r=Object.entries(o.text),s=r.length>199?r.length+51:200;t.addRow(["索引",...n]),r.forEach((o=>t.addRow([o[0],...n.map((e=>o[1][e]))]))),r.length>199&&[...new Array(50).keys()].forEach((()=>t.addRow([]))),[...new Array(n.length+2)].forEach(((o,e)=>{t.getColumn(e+1).width=50})),(null!==(e=t.getRows(1,s))&&void 0!==e?e:[]).forEach(((o,e)=>{o.alignment={horizontal:"center",vertical:"middle"},o.height=30,o.font=0===e?Object.assign(Object.assign({},i),{color:{argb:"ffff6666"}}):i}))})):e.forEach((o=>{var e;const t=a.addWorksheet(o,{views:[{state:"frozen",xSplit:1,ySplit:1}]});t.addRow(["索引",...n]),t.addRow(["你好",...n.map((o=>Wo[o]))]),[...new Array(198).keys()].forEach((()=>t.addRow([]))),[...new Array(n.length+2)].forEach(((o,e)=>{t.getColumn(e+1).width=50})),(null!==(e=t.getRows(1,200))&&void 0!==e?e:[]).forEach(((o,e)=>{o.alignment={horizontal:"center",vertical:"middle"},o.height=30,o.font=0===e?Object.assign(Object.assign({},i),{color:{argb:"ffff6666"}}):i}))})),yield a.xlsx.writeFile(E("i18n.xlsx")),r.stop(),console.log(h.done),s(1)}))}