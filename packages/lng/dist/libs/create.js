var x=this&&this.__awaiter||function(o,t,e,n){return new(e||(e=Promise))((function(r,i){function a(o){try{c(n.next(o))}catch(o){i(o)}}function s(o){try{c(n.throw(o))}catch(o){i(o)}}function c(o){var t;o.done?r(o.value):(t=o.value,t instanceof e?t:new e((function(o){o(t)}))).then(a,s)}c((n=n.apply(o,t||[])).next())}))};import{exit as o}from"process";import{AbsPath as S}from"@yangzw/bruce-us/dist/node.js";import Ro from"exceljs";import no from"ora";import{CreateAnswer as ge}from"../helpers/index.js";import{CREATE_TEXT as j}from"../langs/index.js";import{LANG_TEXT as Oo,ShowTitle as io}from"../utils/index.js";export default function u(){return x(this,void 0,void 0,(function*(){io("create");const{cover:t,features:e,jsons:n,langs:r}=yield ge();!t&&o(1);const i=no(j.doing).start(),a=new Ro.Workbook,s={bold:!0,color:{argb:"ff333333"},family:3,name:"Microsoft YaHei",size:14};a.creator="JowayYoung",n.length?n.forEach((o=>{var t;const e=a.addWorksheet(o.name,{views:[{state:"frozen",xSplit:1,ySplit:1}]}),n=Object.entries(o.text),i=n.length>199?n.length+51:200;e.addRow(r),n.forEach((o=>e.addRow(r.map((t=>o[1][t]))))),n.length>199&&[...new Array(50).keys()].forEach((()=>e.addRow([]))),r.forEach(((o,t)=>e.getColumn(t+1).width=50)),(null!==(t=e.getRows(1,i))&&void 0!==t?t:[]).forEach(((o,t)=>{o.alignment={horizontal:"center",vertical:"middle"},o.height=30,o.font=0===t?Object.assign(Object.assign({},s),{color:{argb:"ffff6666"}}):s}))})):e.forEach((o=>{var t;const e=a.addWorksheet(o,{views:[{state:"frozen",xSplit:1,ySplit:1}]});e.addRow(r),e.addRow(r.map((o=>Oo[o]))),[...new Array(198).keys()].forEach((()=>e.addRow([]))),r.forEach(((o,t)=>e.getColumn(t+1).width=50)),(null!==(t=e.getRows(1,200))&&void 0!==t?t:[]).forEach(((o,t)=>{o.alignment={horizontal:"center",vertical:"middle"},o.height=30,o.font=0===t?Object.assign(Object.assign({},s),{color:{argb:"ffff6666"}}):s}))})),yield a.xlsx.writeFile(S("i18n.xlsx")),i.stop(),console.log(j.done),o(1)}))}