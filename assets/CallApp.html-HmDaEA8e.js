import{_ as t}from"./plugin-vue_export-helper-x3n3nnut.js";import{o as s,c as e,e as n}from"./app-0LG0iRWf.js";const a={},l=n(`<p>第一个参数以<code>对象解构</code>的方式入参</p><table><thead><tr><th style="text-align:center;">入参</th><th style="text-align:center;">功能</th><th style="text-align:center;">类型</th><th style="text-align:center;">默认</th><th>说明</th></tr></thead><tbody><tr><td style="text-align:center;"><strong>download</strong></td><td style="text-align:center;">下载地址</td><td style="text-align:center;"><code>String</code></td><td style="text-align:center;"><code>&quot;&quot;</code></td><td>当所有下载地址都匹配不上，就用这个下载地址作为兜底地址</td></tr><tr><td style="text-align:center;"><strong>downloadAndroid</strong></td><td style="text-align:center;">Android下载地址</td><td style="text-align:center;"><code>String</code></td><td style="text-align:center;"><code>&quot;&quot;</code></td><td>Google Play或国内四大手机应用商店提供的下载地址</td></tr><tr><td style="text-align:center;"><strong>downloadIos</strong></td><td style="text-align:center;">iOS下载地址</td><td style="text-align:center;"><code>String</code></td><td style="text-align:center;"><code>&quot;&quot;</code></td><td>App Store提供的下载地址</td></tr><tr><td style="text-align:center;"><strong>downloadYyb</strong></td><td style="text-align:center;">应用宝下载地址</td><td style="text-align:center;"><code>String</code></td><td style="text-align:center;"><code>&quot;&quot;</code></td><td>腾讯应用宝提供的下载地址，如果网页可能在微信中打开就要配置此项</td></tr><tr><td style="text-align:center;"><strong>host</strong></td><td style="text-align:center;">域名</td><td style="text-align:center;"><code>String</code></td><td style="text-align:center;"><code>&quot;&quot;</code></td><td></td></tr><tr><td style="text-align:center;"><strong>params</strong></td><td style="text-align:center;">查询参数</td><td style="text-align:center;"><code>Object</code></td><td style="text-align:center;"><code>{}</code></td><td>如果键值为对象，请用JSON.stringify()反序列化数据</td></tr><tr><td style="text-align:center;"><strong>path</strong></td><td style="text-align:center;">路径</td><td style="text-align:center;"><code>String</code></td><td style="text-align:center;"><code>&quot;&quot;</code></td><td></td></tr><tr><td style="text-align:center;"><strong>protocol</strong></td><td style="text-align:center;">协议</td><td style="text-align:center;"><code>String</code></td><td style="text-align:center;"><code>&quot;&quot;</code></td><td>无需带上//:</td></tr></tbody></table><p>第二个参数以<code>对象解构</code>的方式入参</p><table><thead><tr><th style="text-align:center;">入参</th><th style="text-align:center;">功能</th><th style="text-align:center;">类型</th><th style="text-align:center;">默认</th><th>说明</th></tr></thead><tbody><tr><td style="text-align:center;"><strong>debug</strong></td><td style="text-align:center;">调试</td><td style="text-align:center;"><code>Boolean</code></td><td style="text-align:center;"><code>false</code></td><td>建议在测试环境打开，可以输出scheme和link(最终下载地址)</td></tr><tr><td style="text-align:center;"><strong>fail</strong></td><td style="text-align:center;">失败回调函数</td><td style="text-align:center;"><code>Function</code></td><td style="text-align:center;">-</td><td>可以自定义业务逻辑</td></tr><tr><td style="text-align:center;"><strong>start</strong></td><td style="text-align:center;">开始回调函数</td><td style="text-align:center;"><code>Function</code></td><td style="text-align:center;">-</td><td>可以自定义业务逻辑</td></tr><tr><td style="text-align:center;"><strong>startWechat</strong></td><td style="text-align:center;">开始回调函数(在微信内)</td><td style="text-align:center;"><code>Function</code></td><td style="text-align:center;">-</td><td>在微信内使用时，可以自定义业务逻辑</td></tr><tr><td style="text-align:center;"><strong>timeout</strong></td><td style="text-align:center;">时延</td><td style="text-align:center;"><code>Number</code></td><td style="text-align:center;"><code>3000</code></td><td>单位毫秒<code>ms</code>，尝试唤起应用，如果唤起失败则在指定时延后打开指定下载地址</td></tr></tbody></table><ul class="task-list-container"><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-0" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-0"> 用于唤起在移动端内已经安装的应用，适用于<code>Android</code>和<code>iOS</code></label></li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-1" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-1"> 如果应用已经安装，则唤起应用并打开应用内对应网页</label></li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-2" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-2"> 如果应用没有安装，则等待指定时间之后打开系统对应下载地址或指定下载地址</label></li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-3" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-3"><code>host</code>和<code>path</code>其实可以视为一个提供高度随意拼接字符串的字段，在此增强<code>Scheme</code>的可用性和扩展性</label></li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> CallApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@yangzw/bruce-us/dist/web&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// 唤起一个应用，业务方提供这条Scheme，如果唤起失败在4秒之后打开指定下载地址</span>
<span class="token comment">// cloudgame//:xyz.share/123?action=openApp&amp;params={&quot;data&quot;:{&quot;a&quot;:1,&quot;b&quot;:2}}</span>

<span class="token keyword">const</span> callApp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CallApp</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	<span class="token literal-property property">download</span><span class="token operator">:</span> <span class="token string">&quot;https://baidu.com&quot;</span><span class="token punctuation">,</span>
	<span class="token literal-property property">downloadAndroid</span><span class="token operator">:</span> <span class="token string">&quot;https://play.google.com/store/apps/details?id=com.netease.ko&amp;hl=zh&amp;gl=cn&quot;</span><span class="token punctuation">,</span>
	<span class="token literal-property property">downloadIos</span><span class="token operator">:</span> <span class="token string">&quot;https://apps.apple.com/cn/app/id1279207754&quot;</span><span class="token punctuation">,</span>
	<span class="token literal-property property">downloadYyb</span><span class="token operator">:</span> <span class="token string">&quot;https://sj.qq.com/appdetail/com.netease.hyxd&quot;</span><span class="token punctuation">,</span>
	<span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">&quot;xyz.share&quot;</span><span class="token punctuation">,</span>
	<span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token literal-property property">action</span><span class="token operator">:</span> <span class="token string">&quot;openApp&quot;</span><span class="token punctuation">,</span>
		<span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&quot;/123&quot;</span><span class="token punctuation">,</span>
	<span class="token literal-property property">protocol</span><span class="token operator">:</span> <span class="token string">&quot;cloudgame&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">debug</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
	<span class="token literal-property property">timeout</span><span class="token operator">:</span> <span class="token number">5000</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 通过点击事件触发</span>
<span class="token keyword">const</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;btn&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
btn<span class="token operator">?.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> callApp<span class="token punctuation">.</span><span class="token function">onCall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 网页加载之后触发</span>
<span class="token keyword">const</span> body <span class="token operator">=</span> document<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
body<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;load&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> callApp<span class="token punctuation">.</span><span class="token function">onCall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>测试覆盖情况</p></blockquote><ul><li>安装应用 <ul class="task-list-container"><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-4" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-4"> Android浏览器期望：点击之后跳出浏览器拉起应用，如果返回浏览器则继续前往<code>Android下载页</code></label></li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-5" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-5"> iOS浏览器期望：点击之后跳出浏览器拉起应用，如果返回浏览器则继续前往<code>iOS下载页</code>，在<code>Safari</code>中有一定概率被拦截</label></li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-6" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-6"> 微信期望(具备可能性)：点击之后跳出微信拉起应用，如果返回微信则继续前往应用宝下载页</label></li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-7" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-7"> 微信期望(具备可能性)：点击之后弹出阻止跳出的弹窗，说明这个应用不在微信白名单中，让法务或业务办理微信服务号业务即可</label></li></ul></li><li>未安装应用 <ul class="task-list-container"><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-8" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-8"> Android浏览器期望：点击之后等待5秒前往<code>Android下载页</code></label></li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-9" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-9"> iOS浏览器期望：点击之后等待5秒前往<code>iOS下载页</code>，在<code>Safari</code>中有一定概率被拦截</label></li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-10" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-10"> 微信期望：点击之后等待5秒前往应用宝下载页</label></li></ul></li></ul><blockquote><p>最终实际情况</p></blockquote><ul><li><code>iOS</code>中未下载应用，在<code>Safari</code>中被拦截，其它浏览器不受影响</li><li>两端的微信都拦截<code>Scheme</code></li><li>其它情况根据预期通过</li></ul>`,10),o=[l];function c(p,i){return s(),e("div",null,o)}const u=t(a,[["render",c],["__file","CallApp.html.vue"]]);export{u as default};
